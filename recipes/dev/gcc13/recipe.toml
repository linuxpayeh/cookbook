#TODO not compiled or tested
[source]
tar = "https://gitlab.redox-os.org/redox-os/gcc/-/archive/redox-13.2.0/gcc-redox-13.2.0.tar.gz"
blake3 = "6c2464b697c249611fe4586d4e4169649ead6c8b85fcf93bb2f82503b8c051ea"
#git = "https://gitlab.redox-os.org/redox-os/gcc.git"
#upstream= "https://gcc.gnu.org/git/gcc.git"
#branch= "redox-13.2.0"
[build]
template = "custom"
dependencies = [
    "relibc",
]
script = """
./contrib/download_prerequisites
cp config.sub gmp/config.sub
cp config.sub isl/config.sub
cp config.sub mpfr/config.sub
cp -f config.sub mpc/config.sub
ln -sf "${COOKBOOK_SYSROOT}/include" "${COOKBOOK_SYSROOT}/usr/include"
ln -sf "${COOKBOOK_SYSROOT}/lib" "${COOKBOOK_SYSROOT}/usr/lib"
COOKBOOK_CONFIGURE_FLAGS+=(
    --with-sysroot=/
    --with-build-sysroot="${COOKBOOK_SYSROOT}"
    --with-static-standard-libraries
    --disable-dlopen
    --disable-lto
    --disable-nls
    --enable-languages=c,c++
    --enable-shared
    --enable-static
    --enable-threads=posix
)
cookbook_configure
"$REDOX_MAKE" -j "$(nproc)" all-gcc all-target-libgcc all-target-libstdc++-v3
"$REDOX_MAKE" DESTDIR="${COOKBOOK_STAGE}" install-gcc install-target-libgcc install-target-libstdc++-v3
find "${COOKBOOK_STAGE}"/{bin,libexec} -exec $STRIP {} ';' 2> /dev/null
ln -s "gcc" "$1/bin/cc"
"""
[package]
dependencies = [
    "gnu-binutils",
    "relibc",
]
